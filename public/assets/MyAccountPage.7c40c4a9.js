import{_ as A,cr as w,T as D,u as g,U as P,d as n,o as h,e as b,w as t,j as i,t as d,i as v,g as a,h as o,f as S,aq as U}from"./index.ec7eb99e.js";import{Q as k}from"./QForm.74e427bf.js";import{Q as R}from"./QPage.b13c45b6.js";import{P as F}from"./ParqForm.cc3166b0.js";import{A as M}from"./AddressFields.afbf970a.js";import"./mixins.af528ab3.js";import"./StateSelect.d3ce42fc.js";import"./index.becf6c0c.js";import"./CitySelect.367b922a.js";import"./BaseSectionSkeleton.971da8dd.js";import"./QSkeleton.73bc54f6.js";import"./page.e7247b54.js";import"./QExpansionItem.38c12bfd.js";import"./QSlideTransition.d1b840b3.js";import"./QMenu.76199ca9.js";import"./selection.571043d0.js";import"./SkeletonSinglePage.dba71dd3.js";const B={components:{ParqForm:F,FileSelector:w,AddressFields:M},data(){return{loading:!1,errors:{}}},methods:{...D(g,["update","currentUser","setIsDirt","setIsLoading","requestAccountDeletion"]),onSaveProfile(){console.func("pages/MyAccountPage:methods.onSaveProfile()",arguments),this.loading=!0,this.errors={},this.update({...this.user,guard:this.$route.meta.guard}).then(()=>{this.loading=!1}).catch(({errors:e,message:r})=>{this.loading=!1,e?this.errors=e:this.$core.error(r)})},onDeleteAccount(){console.func("pages/MyAccountPage:methods.onDeleteAccount()",arguments),this.$core.confirm(this.$t("deletingYourAccountWillRemoveAllOfYourInformationFromOurDatabaseThisCannotBeUndone"),{title:this.$t("weReSorryToSeeYouGo")}).then(()=>{this.$core.showLoading("Processing account deletion request..."),this.requestAccountDeletion().then(()=>{this.$core.hideLoading()}).catch(({message:e})=>{this.$core.hideLoading(),this.$core.error(e)})})}},computed:{...P(g,["user","deletionRequest","hasDeletionRequest"]),avatar(){return this.$route.query.avatar},deletionRequestedAt(){var e;return this.$core.formatDateAsHuman((e=this.deletionRequest)==null?void 0:e.created_at)}},mounted(){this.avatar&&this.$refs.avatar.onFileBrowse()},watch:{loading:{deep:!0,immediate:!0,handler(e){this.setIsDirt(e),this.setIsLoading(e)}}}},C={class:"row q-col-gutter-lg"},I={class:"col-xs-12 col-sm-9"},N={class:"row q-col-gutter-md"},Q={class:"col-sm-3 col-xs-12"},E={class:"col-sm-3 col-xs-12"},L={class:"col-sm-4 col-xs-12"},T={class:"col-sm-4 col-xs-12"},Y={class:"col-sm-4 col-xs-12"},O={key:0,class:"col-xs-12"},j={class:"col-sm col-xs-12 flex"},z={class:"col-xs-12 col-sm-3"},G={class:"col-xs-12"},H={class:"col-xs-12 col-sm-9"};function W(e,r,J,K,l,c){const _=n("base-info"),m=n("base-label"),u=n("base-input"),p=n("base-btn"),q=n("address-fields"),f=n("base-section"),$=n("file-selector"),V=n("parq-form");return h(),b(R,{padding:""},{default:t(()=>[e.hasDeletionRequest?(h(),b(_,{key:0,color:"negative",rounded:"",class:"q-mb-md"},{default:t(()=>[i(d(e.$t("requestToDeleteYourAccount",{date:c.deletionRequestedAt})),1)]),_:1})):v("",!0),a("div",C,[a("div",I,[o(f,{flat:"",bordered:"","no-row":"",title:e.$t("profileInformation")},{default:t(()=>[o(k,{onSubmit:c.onSaveProfile},{default:t(()=>[a("div",N,[a("div",Q,[o(m,null,{default:t(()=>[i(d(e.$t("firstName")),1)]),_:1}),o(u,{"error-message":e.$core.errorMessage("first_name",l.errors),error:e.$core.hasError("first_name",l.errors),modelValue:e.user.first_name,"onUpdate:modelValue":r[0]||(r[0]=s=>e.user.first_name=s),name:"first_name"},null,8,["error-message","error","modelValue"])]),a("div",E,[o(m,null,{default:t(()=>[i(d(e.$t("surname")),1)]),_:1}),o(u,{"error-message":e.$core.errorMessage("last_name",l.errors),error:e.$core.hasError("last_name",l.errors),modelValue:e.user.last_name,"onUpdate:modelValue":r[1]||(r[1]=s=>e.user.last_name=s),name:"last_name"},null,8,["error-message","error","modelValue"])]),a("div",L,[o(m,null,{default:t(()=>[i(d(e.$t("email")),1)]),_:1}),o(u,{"error-message":e.$core.errorMessage("email",l.errors),error:e.$core.hasError("email",l.errors),modelValue:e.user.email,"onUpdate:modelValue":r[2]||(r[2]=s=>e.user.email=s),name:"email"},null,8,["error-message","error","modelValue"])]),a("div",T,[o(m,null,{default:t(()=>[i(d(e.$t("phoneNumber")),1)]),_:1}),o(u,{"error-message":e.$core.errorMessage("phone_number",l.errors),error:e.$core.hasError("phone_number",l.errors),modelValue:e.user.phone_number,"onUpdate:modelValue":r[3]||(r[3]=s=>e.user.phone_number=s),name:"phone_number"},null,8,["error-message","error","modelValue"])]),a("div",Y,[o(m,null,{default:t(()=>[i(d(e.$t("password")),1)]),_:1}),o(u,{type:"password",readonly:"","bottom-slots":"",modelValue:"**********",name:"password"},{hint:t(()=>[o(p,{size:"11px",color:"grey",to:{name:"Forget Password",query:{email:e.user.email}},link:"",type:"a",label:e.$t("forgottenPassword")},null,8,["to","label"])]),_:1})]),e.user.address?(h(),S("div",O,[o(q,{prefix:"address.",errors:l.errors,modelValue:e.user.address,"onUpdate:modelValue":r[4]||(r[4]=s=>e.user.address=s)},null,8,["errors","modelValue"])])):v("",!0),a("div",j,[o(p,{link:"",label:e.$t("deleteAccount"),class:"q-mr-md",color:"negative",onClick:c.onDeleteAccount,disable:e.hasDeletionRequest},null,8,["label","onClick","disable"]),o(U),o(p,{loading:l.loading,style:{width:"100px"},label:e.$t("save"),type:"submit"},null,8,["loading","label"])])])]),_:1},8,["onSubmit"])]),_:1},8,["title"])]),a("div",z,[o(f,{flat:"",bordered:"",title:e.$t("avatar")},{default:t(()=>[a("div",G,[o($,{ref:"avatar",accept:"image/*","dialog-label":e.$t("uploadAvatar"),hint:e.$t("hint.images",{type:"avatar"}),readonly:e.user.avatar&&!e.user.request_avatar,modelValue:e.user.avatar,"onUpdate:modelValue":[r[5]||(r[5]=s=>e.user.avatar=s),c.onSaveProfile]},null,8,["dialog-label","hint","readonly","modelValue","onUpdate:modelValue"])])]),_:1},8,["title"])]),a("div",H,[o(f,{flat:"",bordered:"",title:e.$t("parQ"),description:e.$t("myAccount.parqDesc"),"no-row":""},{default:t(()=>{var s;return[o(V,{readonly:!((s=e.user)!=null&&s.request_parq),member:e.user,"onUpdate:member":r[6]||(r[6]=y=>e.user=y)},null,8,["readonly","member"])]}),_:1},8,["title","description"])])])]),_:1})}var fe=A(B,[["render",W]]);export{fe as default};

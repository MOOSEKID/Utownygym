import{bt as i,c as r,A as l}from"./index.ec7eb99e.js";const o=e=>new Promise((a,s)=>{l.post("users/import",e).then(t=>{a(t)}).catch(t=>{s(t)})}),c=()=>r.csvImportDialog({title:"Import members by CSV",sampleFile:"/csv/users.csv",importMethod:o,options:[{label:"Overwrite existing users that have the same email",type:"checkbox",key:"email_overwrite",value:!1}]}),u=e=>[{label:e.$t("label.active"),value:!0},{label:e.$t("label.nSPast7Days"),value:"no-show"},{label:e.$t("label.lCPast7Days"),value:"late-cancellation"},{label:e.$t("label.blocked"),value:"blocked"}],d=e=>new Promise((a,s)=>{l.post(`users/${e.id}/mark-as-paid`,e).then(t=>{const{message:n}=t;r.success(n),a(t)}).catch(t=>{r.error(t),s(t)})}),b=i("member",{state:()=>({rows:[],permissions:{new:"members:new",edit:"members:edit",delete:"members:delete"}}),getters:{module:e=>({name:"Members",label:e.$t("label.members"),singular:e.$t("singular.member"),plural:e.$t("plural.members")}),columns:e=>[{name:"id",align:"left",label:e.$t("label.memberID"),field:"member_id_formated",style:"width: 40px",sortable:!0},{name:"avatar",align:"left",field:"avatar",style:"width: 40px"},{name:"name",align:"left",label:e.$t("label.name"),field:"name",style:"width: 40px",sortable:!0},{name:"email",align:"left",label:e.$t("label.email"),field:"email",style:"width: 40px",sortable:!0},{name:"phone_number",align:"left",label:e.$t("label.contact"),field:"phone_number",style:"width: 40px",sortable:!0},{name:"status",align:"center",label:e.$t("label.status"),field:"status",style:"width: 40px",sortable:!0},{name:"subscription",align:"center",label:e.$t("label.subscription"),field:"subscription_status",style:"width: 40px",sortable:!1},{name:"last_login",align:"left",label:e.$t("label.lastLogin"),field:"last_login",format:a=>r.formatDateAsHuman(a==null?void 0:a.created_at),style:"width: 40px",sortable:!0},{name:"ns_bookings_count",align:"center",label:e.$t("label.nS"),field:"ns_bookings_count",style:"width: 40px",sortable:!1,status:["no-show"]},{name:"last_ns_bookings",align:"left",label:e.$t("label.lastNS"),field:"last_ns_bookings",format:a=>r.formatDateAsHuman(a==null?void 0:a.schedules_at),style:"width: 40px",sortable:!0,status:["no-show","blocked"]},{name:"late_cancellation_count",align:"center",label:e.$t("label.lC"),field:"late_cancellation_count",style:"width: 40px",sortable:!1,status:["late-cancellation"]},{name:"last_late_cancellation",align:"left",label:e.$t("label.lastLC"),field:"last_late_cancellation",format:a=>r.formatDateAsHuman(a==null?void 0:a.schedules_at),style:"width: 40px",sortable:!0,status:["late-cancellation","blocked"]},{name:"release_at",align:"left",label:e.$t("label.releaseAt"),field:"blocked",format:a=>a?`[${a==null?void 0:a.type}] ${r.formatDateAsHuman(a==null?void 0:a.release_at)}`:null,style:"width: 40px",sortable:!1,status:["blocked"]},{name:"is_active",align:"left",label:e.$t("label.active"),field:"is_active",style:"width: 40px",format:a=>a?"Yes":"No",sortable:!0},{name:"actions",align:"right",sortable:!1}],toolbar:e=>[{label:e.$t("label.trashed"),action:"request",component:"base-toggle",dense:!0,key:"deleted",checkedIcon:"delete",permission:"members:delete",guard:["admins"],deleted:"all"},{title:e.$t("label.status"),action:"request",component:"base-select",dense:!0,outlined:!0,key:"status",placeholder:e.$t("placeholder.select"),optionsDense:!0,style:"width: 180px",mapOptions:!0,emitValue:!0,options:u(e),deleted:"all",prefix:e.$t("prefix.status")},{title:e.$t("label.rag"),action:"request",component:"base-select",dense:!0,outlined:!0,key:"rag",placeholder:e.$t("placeholder.rag"),optionsDense:!0,style:"width: 120px",mapOptions:!0,emitValue:!0,options:[null,"red","green","amber","white"].map(a=>({label:a?`<div class="text-center"><i class="q-icon fas fa-circle rag-${a}" style="font-size: 13px;" aria-hidden="true" role="presentation" ></i></div>`:`<div class="text-center">${e.$t("label.all")}</div>`,value:a})),optionsHtml:!0,prefix:e.$t("prefix.rag"),deleted:"all"},{tooltip:e.$t("tooltip.exportAsCsv"),icon:"fas fa-file-csv",action:"export",color:"grey",deleted:"all",type:"csv"},{icon:"fad fa-file-import",tooltip:e.$t("importByCsv"),permission:"members:new",action:c,color:"grey",deleted:"all"},{icon:"fad fa-plus-circle",label:e.$t("label.addMember"),permission:"members:new",action:"route",params:{id:"add"},route:"Member",color:"primary",deleted:"all"}],actions:e=>[{label:e.$t("label.edit"),permission:"members:edit",action:"route",route:"Member",params:a=>({id:a.id}),query:a=>({action:"edit"}),icon:"fas fa-edit",deleted:!1},{label:a=>a.has_blocked?"Unblock":"Block",action:a=>e.changeBlock(a),condition:a=>["no-show","late-cancellation","blocked"].includes(a.pagination.status),icon:a=>a.has_blocked?"fas fa-circle-stop":"fas fa-ban",deleted:!1},{label:a=>a.request_parq?"PARQ Received":"Request PARQ",action:a=>e.requestParq(a),icon:a=>(a.request_parq,"fas fa-clipboard-question"),deleted:!1},{label:a=>a.request_avatar?"Avatar Uploaded":"Request Avatar",action:a=>e.requestAvatar(a),icon:a=>a.request_avatar?"fas fa-image-polaroid":"fas fa-image-polaroid-user",deleted:!1},{label:e.$t("label.delete"),permission:"members:delete",action:"delete",icon:"fas fa-trash-alt",deleted:!1},{label:e.$t("label.restore"),permission:"members:delete",action:"restore",icon:"fas fa-trash-undo",deleted:!0}],filters:e=>[]},actions:{get(e){return new Promise((a,s)=>{l.get("users",e).then(t=>{this.setRows(t.data),a(t)}).catch(t=>{s(t)})})},options(e){return new Promise((a,s)=>{l.get("users/options",e).then(t=>{this.setRows(t.data),a(t)}).catch(t=>{s(t)})})},store(e){return new Promise((a,s)=>{l.post("users/store",e).then(t=>{a(t)}).catch(t=>{s(t)})})},show(e){return new Promise((a,s)=>{l.get(`users/${e}`).then(t=>{t.address||Object.assign(t,{address:{}}),a(t)}).catch(t=>{s(t)})})},shows(e){return new Promise((a,s)=>{l.post("users/list-by-ids",e).then(t=>{a(t)}).catch(t=>{s(t)})})},update(e){return new Promise((a,s)=>{l.put(`users/${e.id}`,e).then(t=>{a(t)}).catch(t=>{s(t)})})},delete(e){return new Promise((a,s)=>{l.delete(`users/${e}/destroy`).then(t=>{a(t)}).catch(t=>{s(t)})})},deleteSelected(e){return new Promise((a,s)=>{l.delete("users/destroy",{items:e}).then(t=>{a(t)}).catch(t=>{s(t)})})},restore(e){return new Promise((a,s)=>{l.post(`users/${e}/restore`).then(t=>{a(t)}).catch(t=>{s(t)})})},restoreSelected(e){return new Promise((a,s)=>{l.post("users/restore",{items:e}).then(t=>{a(t)}).catch(t=>{s(t)})})},changeActive(e){return new Promise((a,s)=>{l.post(`users/${e.id}/change-active`).then(t=>{e.is_active=!e.is_active;const{message:n}=t;r.success(n),a(t)}).catch(t=>{r.error(t),s(t)})})},changeBlock(e){return new Promise((a,s)=>{l.post(`users/${e.id}/change-block`).then(t=>{e.has_blocked=!e.has_blocked;const{message:n}=t;r.success(n),a(t)}).catch(t=>{r.error(t),s(t)})})},notes(e){return new Promise((a,s)=>{l.post(`users/${e.moduleId}/notes`,e).then(t=>{a(t)}).catch(t=>{s(t)})})},schedules(e){return new Promise((a,s)=>{l.get(`users/${e.moduleId}/schedules`,e).then(t=>{a(t)}).catch(t=>{s(t)})})},schedulesCalendar(e){return new Promise((a,s)=>{l.get(`users/${e.moduleId}/schedules-calendar`,e).then(t=>{a(t)}).catch(t=>{s(t)})})},showByQrcode(e){return new Promise((a,s)=>{l.get(`users/show-by-qrcode/${e}`).then(t=>{a(t)}).catch(t=>{s(t)})})},markAsPaid:d,requestAvatar(e){return e.loading=!0,new Promise((a,s)=>{l.post(`users/${e.id}/request-avatar`).then(t=>{e.loading=!1,e.request_avatar=!e.request_avatar;const{message:n}=t;r.success(n),a(t)}).catch(t=>{e.loading=!1,r.error(t),s(t)})})},requestParq(e){return e.loading=!0,new Promise((a,s)=>{l.post(`users/${e.id}/request-parq`).then(t=>{e.loading=!1,e.request_parq=!e.request_parq;const{message:n}=t;r.success(n),a(t)}).catch(t=>{e.loading=!1,r.error(t),s(t)})})}}});export{c as i,b as u};

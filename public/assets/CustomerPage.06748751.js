import{bt as T,A as q,_ as N,d,o as m,e as v,S as U,w as s,g as o,h as t,s as V,R as S,N as g,W as k,j as i,t as _,f as y,F as w,p as O,Q as B,m as x,T as E,aY as L,aZ as z,O as F}from"./index.ec7eb99e.js";import{Q as I}from"./QPage.b13c45b6.js";import{A as J}from"./AddressCard.b85d39e7.js";import{S as j}from"./SkeletonSinglePage.dba71dd3.js";import"./QSkeleton.73bc54f6.js";const H=T("customer",{actions:{show(r){return new Promise((e,n)=>{q.get(`customers/${r}`).then(c=>{e(c)}).catch(c=>{n(c)})})},update(r){return new Promise((e,n)=>{q.put(`customers/${r.id}`,r).then(c=>{e(c)}).catch(c=>{n(c)})})}}}),G={props:{order:{type:Object,required:!1},customer:{type:Number,required:!0}},computed:{hasOrder(){return Boolean(this.order)}}},W={class:"row q-col-gutter-md"},Y={key:1,class:"row flex-center",style:{height:"250px"}},Z={class:"text-center"},K={class:"q-mb-sm"},M={class:"text-right"},X={class:"q-gutter-md"};function $(r,e,n,c,l,p){const C=d("base-status"),f=d("base-thumbnail"),b=d("base-btn"),h=d("base-section");return m(),v(h,{"no-row":"",title:"Last order placed"},U({default:s(()=>[p.hasOrder?(m(),v(S,{key:0,dense:"",class:"q-px-none"},{default:s(()=>[t(g,null,{default:s(()=>[t(k,{class:"q-gutter-y-xs"},{default:s(()=>[o("div",null,[i(" Order "+_(n.order.formated_id)+" ",1),(m(!0),y(w,null,O(n.order.status,u=>(m(),v(C,{key:u.id,type:u.label},null,8,["type"]))),128))]),o("div",null,_(r.$core.money(n.order.grand_total))+" from "+_(n.order.source),1),o("div",W,[(m(!0),y(w,null,O(n.order.line_items,u=>(m(),y("div",{key:u,class:"col-sm-3 col-xs-12"},[t(S,{class:"q-pa-none"},{default:s(()=>[t(g,{avatar:""},{default:s(()=>[t(f,{media:u.thumbnail,size:"40"},null,8,["media"])]),_:2},1024),t(g,null,{default:s(()=>[t(k,{caption:"",lines:"1"},{default:s(()=>[i(_(u.title),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})]),_:1}),t(g,{side:"",top:""},{default:s(()=>[t(k,{caption:""},{default:s(()=>{var u;return[i(_(r.$core.formatDateAsHuman((u=n.order)==null?void 0:u.created_at)),1)]}),_:1})]),_:1})]),_:1})):(m(),y("div",Y,[o("div",Z,[o("div",K,[t(B,{color:"grey",name:"fad fa-shopping-cart",size:"100px"})]),e[0]||(e[0]=o("div",{class:"q-my-sm text-h6"}," This customer hasn\u2019t placed any orders. ",-1)),t(V,{to:{name:"Order",params:{id:"add"},query:{customer:n.customer}},"no-caps":"",color:"primary",label:"Create order"},null,8,["to"])])]))]),_:2},[p.hasOrder?{name:"bottom",fn:s(()=>[o("div",M,[o("div",X,[t(b,{to:{name:"Orders",query:{customer:n.customer}},link:"","vertical-middel":"",label:"View all orders"},null,8,["to"]),t(V,{to:{name:"Order",params:{id:"add"},query:{customer:n.customer}},color:"primary",label:"Create order","no-caps":""},null,8,["to"])])])]),key:"0"}:void 0]),1024)}var ee=N(G,[["render",$]]);const A={email_marketing:!1,collect_tax:!0},te={components:{AddressCard:J,RecentOrder:ee,SkeletonSinglePage:j},data(){return{default:x.exports.cloneDeep(A),customer:x.exports.cloneDeep(A),loaded:!1,submited:!1}},methods:{...E(H,["show","update"]),onSubmit(r){console.func("pages/admins/orders/CustomerPage:methods.onSubmit()",arguments),this.submited=!0,this.update(this.customer).then(({data:e,message:n})=>{this.submited=!1,this.$q.notify(n),this.customer=e,this.default=x.exports.cloneDeep(e)}).catch(e=>{this.submited=!1,this.$core.error(e,{title:"Error"})})},onReset(r){console.func("pages/admins/orders/CustomerPage:methods.onReset()",arguments),this.loaded=!1,setTimeout(()=>{Object.assign(this.customer,x.exports.cloneDeep(this.default)),this.loaded=!0},1)},onCancel(r){console.func("pages/admins/orders/CustomerPage:methods.onCancel()",arguments),this.$router.back()}},async mounted(){this.show(this.id).then(r=>{this.customer=r,this.default=x.exports.cloneDeep(r),this.loaded=!0}).catch(r=>{this.$core.error(r,{title:"Error"})})},computed:{id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.customer)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.customer)!==JSON.stringify(this.default)}}},se={class:"row q-col-gutter-md"},oe={class:"col-xs-12 col-sm-9"},le={class:"q-gutter-md"},re={class:"col-xs-12 col-sm-4"},ne={class:"col-xs-12 col-sm-4"},ae={class:"col-xs-12 col-sm-4"},de={class:"col-xs-12 col-sm-4"},ie={class:"col-xs-12 col-sm-12"},ue={class:"col-xs-12 col-sm-3"},me={class:"q-gutter-md"},ce={class:"col-sm-12 col-xs-12"},_e={class:"row flex-start"},pe={class:"text-grey"},fe={class:"col-sm-12 col-xs-12"},be={class:"col-sm-12 col-xs-12"},he={class:"text-h6"},ge={class:"text-h6"},ve={class:"col-sm-12 col-xs-12"};function xe(r,e,n,c,l,p){const C=d("recent-order"),f=d("base-label"),b=d("base-input"),h=d("base-section"),u=d("base-btn"),D=d("base-tooltip"),P=d("address-card"),Q=d("base-form"),R=d("skeleton-single-page");return m(),v(I,{padding:""},{default:s(()=>[l.loaded?(m(),v(Q,{key:0,onSubmit:p.onSubmit,onCancel:p.onCancel,onReset:p.onReset,resetable:p.resetable,disable:p.disable,submited:l.submited},{default:s(()=>[o("div",se,[o("div",oe,[o("div",le,[t(C,{customer:l.customer.id,order:l.customer.latest_order},null,8,["customer","order"]),t(h,{title:"General information",description:"Customer information forms provide key data on customer that can be used to keep track of who worked for the company, when, and in what positions."},{default:s(()=>[o("div",re,[t(f,null,{default:s(()=>e[7]||(e[7]=[i("First Name")])),_:1}),t(b,{modelValue:l.customer.first_name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.customer.first_name=a)},null,8,["modelValue"])]),o("div",ne,[t(f,null,{default:s(()=>e[8]||(e[8]=[i("Last name")])),_:1}),t(b,{modelValue:l.customer.last_name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.customer.last_name=a)},null,8,["modelValue"])]),o("div",ae,[t(f,null,{default:s(()=>e[9]||(e[9]=[i("Email Address")])),_:1}),t(b,{dense:"",outlined:"",modelValue:l.customer.email,"onUpdate:modelValue":e[2]||(e[2]=a=>l.customer.email=a)},null,8,["modelValue"])]),o("div",de,[t(f,null,{default:s(()=>e[10]||(e[10]=[i("Phone Number")])),_:1}),t(b,{modelValue:l.customer.phone_number,"onUpdate:modelValue":e[3]||(e[3]=a=>l.customer.phone_number=a)},null,8,["modelValue"])]),o("div",ie,[t(f,null,{default:s(()=>e[11]||(e[11]=[i("Customer Note")])),_:1}),t(b,{dense:"",outlined:"",modelValue:l.customer.note,"onUpdate:modelValue":e[4]||(e[4]=a=>l.customer.note=a)},null,8,["modelValue"])])]),_:1})])]),o("div",ue,[o("div",me,[t(h,{title:"Customer overview",contentClass:"bg-green-1"},{default:s(()=>{var a;return[o("div",ce,[o("div",_e,[t(u,{link:"",padding:"0",label:l.customer.email},null,8,["label"]),t(V,{onClick:e[5]||(e[5]=ye=>r.$core.copyToClipboard(l.customer.email)),flat:"",dense:"",padding:"0",size:"xs",icon:"fas fa-clipboard"},{default:s(()=>[t(D,null,{default:s(()=>e[12]||(e[12]=[i("Copy email")])),_:1})]),_:1})]),o("div",pe," Created at: "+_(r.$core.formatDateAsHuman((a=l.customer)==null?void 0:a.created_at)),1)]),o("div",fe,[t(f,null,{default:s(()=>e[13]||(e[13]=[i("DEFAULT ADDRESS")])),_:1}),t(P,L(z(l.customer.address)),null,16)])]}),_:1}),t(h,{title:"Activity"},{default:s(()=>[o("div",be,[t(S,{dense:"",class:"q-px-none"},{default:s(()=>[t(g,{class:"text-center"},{default:s(()=>[i(" Total spent in "+_(l.customer.total_orders)+" orders ",1),o("div",he,_(r.$core.money(l.customer.total_spent)),1)]),_:1}),t(g,{class:"text-center"},{default:s(()=>[e[14]||(e[14]=i(" Average order amount ")),o("div",ge,_(r.$core.money(l.customer.average_order_amount)),1)]),_:1})]),_:1})])]),_:1}),t(h,{title:"Tax exemption"},{default:s(()=>[o("div",ve,[t(F,{dense:"",modelValue:l.customer.collect_tax,"onUpdate:modelValue":e[6]||(e[6]=a=>l.customer.collect_tax=a),label:"Collect tax"},null,8,["modelValue"])])]),_:1})])])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(m(),v(R,{key:1}))]),_:1})}var we=N(te,[["render",xe]]);export{we as default};

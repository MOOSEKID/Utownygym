import{_ as Q,m as _,T as x,U as B,d as i,o as d,e as g,w as s,h as a,g as l,j as m,t as u,f,cw as N,i as C,F as U,ad as h,ag as D,ah as R,O as I}from"./index.ec7eb99e.js";import{Q as E}from"./QPage.b13c45b6.js";import{S as L}from"./SkeletonSinglePage.dba71dd3.js";import{S as M}from"./SettingsPageHeader.b1719c9d.js";import{u as S}from"./coupon.ca91ec01.js";import{u as T}from"./plan.0dadec60.js";import{P as G}from"./mixins.af528ab3.js";import"./QSkeleton.73bc54f6.js";import"./StateSelect.d3ce42fc.js";import"./index.becf6c0c.js";import"./CitySelect.367b922a.js";import"./BaseSectionSkeleton.971da8dd.js";import"./page.e7247b54.js";import"./QExpansionItem.38c12bfd.js";import"./QSlideTransition.d1b840b3.js";import"./QMenu.76199ca9.js";import"./selection.571043d0.js";const w={fixed:!1,percent_off:0,amount_off:0,duration_in_months:null,duration:"forever",fixed:!1,has_max_redemptions:!1,has_expires_at:!1,specific_plans:!1,plans:[],active:!0},H={mixins:[G],components:{SkeletonSinglePage:L,SettingsPageHeader:M},data(){return{defaultData:_.exports.cloneDeep(w),formData:_.exports.cloneDeep(w)}},methods:{...x(S,["store","show","update"]),...x(T,{getPlans:"get"}),onChangeField(e,o=null){console.func("pages/admins/coupons/CouponPage:methods.onChangeField()",arguments);const{duration_in_months:V,max_redemptions:y,plans:t}=this.defaultData;switch(o){case"has_max_redemptions":Object.assign(this.formData,{max_redemptions:e?y:null});break;case"has_expires_at":const{expires_at:p}=this.defaultData;Object.assign(this.formData,{expires_at:e?p:null});break;case"specific_plans":Object.assign(this.formData,{plans:e?t:[]});break;case"duration":const r=!["forever","once"].includes(e);Object.assign(this.formData,{duration_in_months:r?V||2:null});break}}},async mounted(){this.creating?this.loaded=!0:this.show(this.id).then(e=>{this.formData=e,this.defaultData=_.exports.cloneDeep(e),this.loaded=!0}).catch(e=>{this.$emit("error",e)})},computed:{...B(S,["intervalOptions","durationOptions"])}},W={class:"q-gutter-md"},z={class:"col-xs-12 col-sm-6"},J={class:"col-xs-12 col-sm-6"},K={key:0,class:"col-xs-12 col-sm-12"},X={class:"col-xs-12 col-sm-4"},Y={class:"col-xs-12 col-sm-4"},Z={key:1,class:"col-xs-12 col-sm-4"},$={class:"col-xs-12"},ee={class:"col-xs-12"},oe={class:"col-xs-12"},te={class:"col-xs-12"};function ne(e,o,V,y,t,p){const v=i("settings-page-header"),r=i("base-label"),c=i("base-input"),O=i("base-price-input"),P=i("base-percentage-input"),k=i("base-select"),b=i("base-checkbox"),q=i("base-date-input"),F=i("base-section"),j=i("base-form"),A=i("skeleton-single-page");return d(),g(E,{padding:""},{default:s(()=>[a(v,{class:"q-pb-md",title:"Coupons","back-route":"Coupons",hint:"Effortlessly manage your coupons in the Settings section for a tailored and seamless experience."}),e.loaded?(d(),g(j,{key:0,onSubmit:e.onSubmit,onCancel:e.onCancel,onReset:e.onReset,resetable:e.resetable,disable:e.disable,submited:e.submited},{default:s(()=>[l("div",W,[a(F,{flat:"",bordered:"",title:e.$t("generalInformation"),description:"Coupons can be used to discount invoices, subscriptions, or entire customer accounts."},{default:s(()=>[l("div",z,[a(r,{required:""},{default:s(()=>[m(u(e.$t("label.name")),1)]),_:1}),a(c,{modelValue:t.formData.name,"onUpdate:modelValue":o[0]||(o[0]=n=>t.formData.name=n),type:"text",hint:e.$t("hint.thisWillAppearOnCustomersReceiptsAndInvoices")},null,8,["modelValue","hint"])]),l("div",J,[a(r,{required:""},{default:s(()=>[m(u(e.$t("label.code")),1)]),_:1}),a(c,{readonly:!e.creating,modelValue:t.formData.promotion_code,"onUpdate:modelValue":o[1]||(o[1]=n=>t.formData.promotion_code=n),type:"text",hint:e.$t("hint.noUpdate",{field:"promotion code"})},null,8,["readonly","modelValue","hint"])]),e.creating?(d(),f("div",K,[a(r,null,{default:s(()=>[m(u(e.$t("label.type")),1)]),_:1}),a(N,{modelValue:t.formData.fixed,"onUpdate:modelValue":o[2]||(o[2]=n=>t.formData.fixed=n),type:"radio",class:"q-gutter-y-sm",dense:"",options:[{label:"Percentage discount",value:!1},{label:"Fixed amount discount",value:!0}]},null,8,["modelValue"])])):C("",!0),l("div",X,[t.formData.fixed?(d(),f(U,{key:0},[a(r,{required:""},{default:s(()=>[m(u(e.$t("label.discountAmount")),1)]),_:1}),a(O,{readonly:!e.creating,modelValue:t.formData.amount_off,"onUpdate:modelValue":o[3]||(o[3]=n=>t.formData.amount_off=n),precision:0,"minimum-fraction-digits":0,hint:e.$t("hint.noUpdate",{field:"discount amount"})},null,8,["readonly","modelValue","hint"])],64)):(d(),f(U,{key:1},[a(r,{required:""},{default:s(()=>[m(u(e.$t("label.percentageOff")),1)]),_:1}),a(P,{readonly:!e.creating,modelValue:t.formData.percent_off,"onUpdate:modelValue":o[4]||(o[4]=n=>t.formData.percent_off=n),hint:e.$t("hint.noUpdate",{field:"percentage off"})},null,8,["readonly","modelValue","hint"])],64))]),l("div",Y,[a(r,null,{default:s(()=>[m(u(e.$t("label.duration")),1)]),_:1}),a(k,{dense:"","map-options":"","emit-value":"",outlined:"","option-label":"label","option-value":"value",modelValue:t.formData.duration,"onUpdate:modelValue":[o[5]||(o[5]=n=>t.formData.duration=n),o[6]||(o[6]=n=>p.onChangeField(n,"duration"))],options:e.durationOptions,readonly:!e.creating,hint:e.$t("hint.noUpdate",{field:"duration"})},null,8,["modelValue","options","readonly","hint"])]),t.formData.duration==="repeating"?(d(),f("div",Z,[a(r,{required:""},{default:s(()=>[m(u(e.$t("label.numberOfMonths")),1)]),_:1}),a(c,{type:"number",step:"1",min:"1",readonly:!e.creating,modelValue:t.formData.duration_in_months,"onUpdate:modelValue":o[7]||(o[7]=n=>t.formData.duration_in_months=n),hint:e.$t("hint.noUpdate",{field:"number of months"})},null,8,["readonly","modelValue","hint"])])):C("",!0),l("div",$,[a(b,{dense:"",readonly:!e.creating,modelValue:t.formData.has_max_redemptions,"onUpdate:modelValue":[o[9]||(o[9]=n=>t.formData.has_max_redemptions=n),o[10]||(o[10]=n=>p.onChangeField(n,"has_max_redemptions"))]},{default:s(()=>[o[18]||(o[18]=l("div",null,"Limit number of times this coupon can be used in total",-1)),h(a(R,{dense:"",outlined:"",readonly:!e.creating,modelValue:t.formData.max_redemptions,"onUpdate:modelValue":o[8]||(o[8]=n=>t.formData.max_redemptions=n),style:{width:"300px"},type:"number",placeholder:"0",min:"0"},null,8,["readonly","modelValue"]),[[D,t.formData.has_max_redemptions]])]),_:1},8,["readonly","modelValue"])]),l("div",ee,[a(b,{dense:"",readonly:!e.creating,modelValue:t.formData.has_expires_at,"onUpdate:modelValue":[o[12]||(o[12]=n=>t.formData.has_expires_at=n),o[13]||(o[13]=n=>p.onChangeField(n,"has_expires_at"))]},{default:s(()=>[o[19]||(o[19]=l("div",null," Limit the date range when customers can redeem this coupon ",-1)),h(a(q,{dense:"",outlined:"",readonly:!e.creating,modelValue:t.formData.expires_at,"onUpdate:modelValue":o[11]||(o[11]=n=>t.formData.expires_at=n),style:{width:"300px"}},null,8,["readonly","modelValue"]),[[D,t.formData.has_expires_at]])]),_:1},8,["readonly","modelValue"])]),l("div",oe,[a(b,{dense:"",modelValue:t.formData.specific_plans,"onUpdate:modelValue":[o[15]||(o[15]=n=>t.formData.specific_plans=n),o[16]||(o[16]=n=>p.onChangeField(n,"specific_plans"))],class:"full-width"},{default:s(()=>[o[20]||(o[20]=l("div",null,"Apply to specific plans",-1)),h(a(k,{dense:"",outlined:"",modelValue:t.formData.plans,"onUpdate:modelValue":o[14]||(o[14]=n=>t.formData.plans=n),multiple:"","use-chips":"","filter-method":e.getPlans,placeholder:"Select plans",class:"q-mt-sm"},null,8,["modelValue","filter-method"]),[[D,t.formData.specific_plans]])]),_:1},8,["modelValue"])]),l("div",te,[a(I,{dense:"",modelValue:t.formData.active,"onUpdate:modelValue":o[17]||(o[17]=n=>t.formData.active=n),label:e.$t("active"),color:"green"},null,8,["modelValue","label"])])]),_:1},8,["title"])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(d(),g(A,{key:1}))]),_:1})}var ye=Q(H,[["render",ne]]);export{ye as default};

import{Q as O}from"./QSelect.ad394656.js";import{Q as H}from"./QExpansionItem.38c12bfd.js";import{T as w,_ as S,d as n,o as m,f as D,g as r,h as o,cr as R,m as g,U as E,u as j,e as b,w as l,j as d,t as u,i as _,Q as P,p as z,ar as G,F as J}from"./index.ec7eb99e.js";import{Q as C,a as K}from"./QTabPanel.fe7180a4.js";import{Q as W}from"./QTimeline.c279b714.js";import{Q as X}from"./QPage.b13c45b6.js";import{u as Y}from"./member.8ccf3331.js";import{U as Z}from"./UserClassSchedules.75392e07.js";import{S as x}from"./SkeletonSinglePage.dba71dd3.js";import{a as $}from"./CurrentPlanCard.a58a65e0.js";import{P as ee}from"./ParqForm.cc3166b0.js";import{u as k}from"./PlanCard.3180e3c1.js";import{I as se}from"./InvoiceManager.402bdc5f.js";import{A as te}from"./AddressFields.afbf970a.js";import{P as oe}from"./mixins.af528ab3.js";import"./QField.ad3f8f9a.js";import"./QChip.cb7fa0e0.js";import"./QMenu.76199ca9.js";import"./selection.571043d0.js";import"./rtl.276c3f1b.js";import"./QSlideTransition.d1b840b3.js";import"./touch.9135741d.js";import"./QBanner.29df4abb.js";import"./QPopupProxy.64b9fae0.js";import"./class-schedule.9cf3b7cc.js";import"./QSkeleton.73bc54f6.js";import"./BaseSectionSkeleton.971da8dd.js";import"./PaymentConfirm.4a4c244a.js";import"./PaymentMethodCard.b5da68e2.js";import"./StateSelect.d3ce42fc.js";import"./index.becf6c0c.js";import"./CitySelect.367b922a.js";import"./page.e7247b54.js";const ae={components:{InvoiceManager:se},props:{user:Object},methods:{...w(k,["setUser"]),async onLoad(){console.func("components/MemberBilling:methods.onLoad()",arguments);try{this.$refs.invoices.onLoad()}catch(e){console.error("components/MemberBilling:methods.onLoad()",e)}}},async mounted(){await this.setUser(this.user)}},le={class:"member-billing"},re={class:"q-gutter-md"};function ne(e,t,p,y,s,f){const V=n("invoice-manager");return m(),D("div",le,[r("div",re,[o(V,{user:p.user,ref:"invoices"},null,8,["user"])])])}var me=S(ae,[["render",ne]]);const U={is_enquiry:!0,status:"Pending",title:"Mr",address:{}},ie={mixins:[oe],components:{SkeletonSinglePage:x,UserClassSchedules:Z,ParqForm:ee,FileSelector:R,MemberBilling:me,CurrentPlanCard:$,AddressFields:te},data(){return{defaultData:g.exports.cloneDeep(U),formData:g.exports.cloneDeep(U),isPwd:!0,isConfPwd:!0,parq:!1,tab:"overview"}},methods:{...w(Y,["store","show","update","notes"]),...w(k,["setUser","removeUser"]),onSubmit(e){console.func("pages/admins/members/MemberPage:methods.onSubmit()",arguments),this.submited=!0,(this.creating?this.store:this.update)(this.formData).then(({data:p,message:y})=>{this.submited=!1,this.$q.notify(y),this.formData=p,this.setUser(p),this.defaultData=g.exports.cloneDeep(p),this.$router.push({name:"Member",params:{id:p.id},query:{action:"edit"}})}).catch(p=>{this.submited=!1,this.$core.error(p,{title:this.$t("dialog.title.error")})})},onChangeStatus(e){console.func("pages/admins/members/MemberPage:methods.onChangeStatus()",arguments),this.formData.is_enquiry=e!=="Active",e!=="Hold"&&(this.formData.release_at=null)},onCreateNote(e){console.func("pages/admins/members/MemberPage:methods.onCreateNote()",arguments),e?(this.formData.notes.splice(0,0,g.exports.cloneDeep(e)),this.defaultData.notes.splice(0,0,g.exports.cloneDeep(e))):this.show(this.id).then(t=>{this.formData=t,this.defaultData=g.exports.cloneDeep(t)})}},async mounted(){this.creating?this.loaded=!0:(this.tab=this.queryTab||this.tab,this.show(this.id).then(async e=>{this.formData=e,this.setUser(e),this.defaultData=g.exports.cloneDeep(e),this.loaded=!0}).catch(e=>{this.$emit("error",e)}))},computed:{...E(j,["user"]),memberOnly(){return!this.creating&&!this.formData.is_enquiry},queryTab(){return this.$route.query.tab},hasClasses(){return!this.creating&&!this.formData.is_enquiry},statusParq(){return this.formData.has_parq?"Completed":"Required"}},watch:{tab(e){this.$router.push({...this.$route,query:{...this.$route.query,tab:e}})}},unmounted(){this.removeUser()}},de={class:"masonry col-gutter-md"},ue={class:"col-xs-12 col-sm-8"},pe={class:"q-gutter-md"},fe={class:"col-xs-12 col-sm-4"},ce={class:"col-xs-12 col-sm-4"},be={class:"col-xs-12 col-sm-4"},_e={class:"col-xs-12 col-sm-4"},he={key:0,class:"col-xs-12 col-sm-4"},ge={key:1,class:"col-xs-12 col-sm-4"},De={class:"col-xs-12 col-sm-4"},ye={key:2,class:"col-xs-12 col-sm-4"},Ve={class:"col-xs-12 col-sm-4"},ve={key:3,class:"col-xs-12 col-sm-12"},we={class:"col-xs-12 col-sm-4"},qe={class:"col-xs-12 col-sm-4"},Pe={class:"col-xs-12 col-sm-4 col-end"},Ce={class:"col-xs-12"},Ue={class:"col-xs-12"},Se={class:"col-xs-12 col-sm-8"},ke={class:"q-gutter-y-md"};function Ae(e,t,p,y,s,f){const V=n("base-page-header"),i=n("base-label"),c=n("base-input"),v=n("base-date-input"),A=n("parq-form"),h=n("base-section"),M=n("address-fields"),Q=n("member-billing"),N=n("current-plan-card"),B=n("base-btn"),T=n("file-selector"),F=n("user-class-schedules"),q=n("base-note-card"),L=n("base-form"),I=n("skeleton-single-page");return m(),b(X,{padding:""},{default:l(()=>[o(V,{class:"q-mb-md",title:e.creating?e.$t("createNew"):s.formData.name,hint:e.$t("hint.member"),tabs:["Overview","Billing"],modelValue:s.tab,"onUpdate:modelValue":t[0]||(t[0]=a=>s.tab=a),"no-tabs":e.creating},null,8,["title","hint","modelValue","no-tabs"]),e.loaded?(m(),b(L,{key:0,onSubmit:f.onSubmit,onCancel:e.onCancel,onReset:e.onReset,resetable:e.resetable,disable:e.disable,submited:e.submited},{default:l(()=>[r("div",de,[r("div",ue,[o(K,{class:"base-tab-panels",modelValue:s.tab,"onUpdate:modelValue":t[18]||(t[18]=a=>s.tab=a)},{default:l(()=>[o(C,{name:"overview"},{default:l(()=>[r("div",pe,[o(h,{flat:"",bordered:"",title:e.$t("generalInformation"),description:e.$t("members.generalDesc")},{default:l(()=>[r("div",fe,[o(i,null,{default:l(()=>[d(u(e.$t("firstName")),1)]),_:1}),o(c,{modelValue:s.formData.first_name,"onUpdate:modelValue":t[1]||(t[1]=a=>s.formData.first_name=a),name:"first_name"},null,8,["modelValue"])]),r("div",ce,[o(i,null,{default:l(()=>[d(u(e.$t("surname")),1)]),_:1}),o(c,{modelValue:s.formData.last_name,"onUpdate:modelValue":t[2]||(t[2]=a=>s.formData.last_name=a),name:"last_name"},null,8,["modelValue"])]),r("div",be,[o(i,null,{default:l(()=>[d(u(e.$t("emailAddress")),1)]),_:1}),o(c,{modelValue:s.formData.email,"onUpdate:modelValue":t[3]||(t[3]=a=>s.formData.email=a),name:"email"},null,8,["modelValue"])]),r("div",_e,[o(i,null,{default:l(()=>[d(u(e.$t("phoneNumber")),1)]),_:1}),o(c,{modelValue:s.formData.phone_number,"onUpdate:modelValue":t[4]||(t[4]=a=>s.formData.phone_number=a),name:"phone_number",type:"tel"},null,8,["modelValue"])]),f.memberOnly?(m(),D("div",he,[o(i,null,{default:l(()=>[d(u(e.$t("startsAt")),1)]),_:1}),o(v,{outlined:"",dense:"",readonly:"",modelValue:s.formData.starts_at,"onUpdate:modelValue":t[5]||(t[5]=a=>s.formData.starts_at=a),"no-range":"",name:"starts_at"},null,8,["modelValue"])])):_("",!0),f.memberOnly?(m(),D("div",ge,[o(i,null,{default:l(()=>[d(u(e.$t("endsAt")),1)]),_:1}),o(v,{outlined:"",dense:"",modelValue:s.formData.ends_at,"onUpdate:modelValue":t[6]||(t[6]=a=>s.formData.ends_at=a),"only-future":"","no-range":"",name:"ends_at",hint:e.$t("hint.endsAt")},null,8,["modelValue","hint"])])):_("",!0),r("div",De,[o(i,null,{default:l(()=>[d(u(e.$t("label.status")),1)]),_:1}),o(O,{dense:"",outlined:"",modelValue:s.formData.status,"onUpdate:modelValue":[t[7]||(t[7]=a=>s.formData.status=a),f.onChangeStatus],options:["Active","Pending","Deactive","Hold","Lost"],name:"status"},null,8,["modelValue","onUpdate:modelValue"])]),s.formData.status==="Hold"?(m(),D("div",ye,[o(i,null,{default:l(()=>[d(u(e.$t("releaseAt")),1)]),_:1}),o(v,{outlined:"",dense:"",modelValue:s.formData.release_at,"onUpdate:modelValue":t[8]||(t[8]=a=>s.formData.release_at=a),name:"release_at"},null,8,["modelValue"])])):_("",!0),r("div",Ve,[o(i,null,{default:l(()=>[d(u(e.$t("keyFob")),1)]),_:1}),o(c,{name:"rfid",modelValue:s.formData.rfid,"onUpdate:modelValue":t[9]||(t[9]=a=>s.formData.rfid=a)},null,8,["modelValue"])]),e.creating?_("",!0):(m(),D("div",ve,[o(H,{"header-class":"bg-grey-3",icon:"fas fa-clipboard-list-check",label:e.$t("parqStatus",{status:f.statusParq}),onShow:t[11]||(t[11]=a=>s.parq=!0),onHide:t[12]||(t[12]=a=>s.parq=!1)},{default:l(()=>[s.parq?(m(),b(A,{key:0,class:"q-pa-md border-all",member:s.formData,"onUpdate:member":t[10]||(t[10]=a=>s.formData=a),readonly:""},null,8,["member"])):_("",!0)]),_:1},8,["label"])]))]),_:1},8,["title","description"]),o(h,{flat:"",bordered:"",title:e.$t("billingAddress"),description:e.$t("members.billingDesc"),"no-row":""},{default:l(()=>[o(M,{modelValue:s.formData.address,"onUpdate:modelValue":t[13]||(t[13]=a=>s.formData.address=a)},null,8,["modelValue"])]),_:1},8,["title","description"]),o(h,{flat:"",bordered:"",title:e.$t("security"),description:e.$t("members.securityDesc")},{default:l(()=>[r("div",we,[o(i,null,{default:l(()=>[d(u(e.$t("password")),1)]),_:1}),o(c,{type:s.isPwd?"password":"text",modelValue:s.formData.password,"onUpdate:modelValue":t[15]||(t[15]=a=>s.formData.password=a),name:"password",color:"blue-grey-14"},{append:l(()=>[o(P,{name:s.isPwd?"fal fa-eye-slash":"fal fa-eye",class:"cursor-pointer",onClick:t[14]||(t[14]=a=>s.isPwd=!s.isPwd),size:"16px"},null,8,["name"])]),_:1},8,["type","modelValue"])]),r("div",qe,[o(i,null,{default:l(()=>[d(u(e.$t("confirmPassword")),1)]),_:1}),o(c,{type:s.isConfPwd?"password":"text",modelValue:s.formData.password_confirmation,"onUpdate:modelValue":t[17]||(t[17]=a=>s.formData.password_confirmation=a),name:"password_confirmation",color:"blue-grey-14"},{append:l(()=>[o(P,{name:s.isConfPwd?"fal fa-eye-slash":"fal fa-eye",class:"cursor-pointer",onClick:t[16]||(t[16]=a=>s.isConfPwd=!s.isConfPwd),size:"16px"},null,8,["name"])]),_:1},8,["type","modelValue"])])]),_:1},8,["title","description"])])]),_:1}),o(C,{name:"billing"},{default:l(()=>[o(Q,{user:s.formData},null,8,["user"])]),_:1})]),_:1},8,["modelValue"])]),r("div",Pe,[!e.creating&&e.loaded?(m(),b(N,{key:0,class:"q-mb-md",user:s.formData,"no-upgrade":"","due-collect":""},null,8,["user"])):_("",!0),o(h,{flat:"",bordered:"",title:e.$t("specialNote")},{bottom:l(()=>[o(B,{link:"",color:"primary",icon:"fas fa-message",label:e.$t("sendMessage"),to:{name:"Enquiry",params:{id:"add"},query:{user:s.formData.id}}},null,8,["label","to"])]),default:l(()=>[r("div",Ce,[o(c,{name:"note",modelValue:s.formData.note,"onUpdate:modelValue":t[19]||(t[19]=a=>s.formData.note=a),type:"textarea"},null,8,["modelValue"])])]),_:1},8,["title"]),o(h,{flat:"",bordered:"",class:"q-mt-md",title:e.$t("avatar")},{default:l(()=>[r("div",Ue,[o(T,{accept:"image/*",icon:"fad fa-image","dialog-label":e.$t("uploadAvatar"),hint:e.$t("hint.images",{type:"avatar"}),modelValue:s.formData.avatar,"onUpdate:modelValue":t[20]||(t[20]=a=>s.formData.avatar=a),name:"avatar"},null,8,["dialog-label","hint","modelValue"])])]),_:1},8,["title"])]),r("div",Se,[r("div",ke,[f.hasClasses?(m(),b(h,{key:0,flat:"",bordered:"",title:"Class Schedules","no-row":""},{default:l(()=>[o(F,{"no-action":"",class:"q-mt-sm","module-id":s.formData.id},null,8,["module-id"])]),_:1})):_("",!0),e.creating?_("",!0):(m(),b(h,{key:1,flat:"",bordered:"",title:e.$t("notes"),description:e.$t("members.activityDesc"),"no-row":"","body-class":"q-px-lg"},{default:l(()=>[o(W,{class:"comments",color:"secondary"},{default:l(()=>[o(q,{"module-action":e.notes,"module-id":s.formData.id,class:"comment",creating:"",onCreate:f.onCreateNote},null,8,["module-action","module-id","onCreate"]),(m(!0),D(J,null,z(s.formData.notes,a=>(m(),b(q,G({class:"comment",key:a.id,ref_for:!0},a,{"module-id":s.formData.id,user:a.admin}),null,16,["module-id","user"]))),128))]),_:1})]),_:1},8,["title","description"]))])])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(m(),b(I,{key:1}))]),_:1})}var ds=S(ie,[["render",Ae]]);export{ds as default};

import{U as q,_ as k,d as m,o as t,e as r,m as h,u as V,f as n,g as c,t as f,i as l,Q as F,n as b,ah as U,w as _,h as d,N as v,W as R,R as A,F as M,p as N,aq as D}from"./index.ec7eb99e.js";import{F as I}from"./FileSelectorDialog.014f4c1d.js";import{u as O}from"./enquiry.b5f57f80.js";const Q={props:{modelValue:String},methods:{onChange(a){console.func("components/EnquiryStatus:methods.onChange",arguments),this.$emit("update:model-value",a)}},computed:{...q(O,["defaultStatusOptions"])}};function T(a,i,s,S,o,e){const p=m("base-select");return t(),r(p,{class:"enquiry-status",options:a.defaultStatusOptions,"model-value":s.modelValue,outlined:"",dense:"","options-html":"","map-options":"","emit-value":"","onUpdate:modelValue":e.onChange},null,8,["options","model-value","onUpdate:modelValue"])}var w=k(Q,[["render",T]]);const g={status:null,message:null,media:[]},E={components:{EnquiryStatus:w},props:{id:[String,Number],avatar:{type:[Boolean,String],required:!1,default:!1},user:{type:[Boolean,Object],required:!1,default:!1},icon:{type:[Boolean,String],required:!1,default:!1},creating:Boolean,isAdmin:Boolean,created_at:String,message:String,media:Array,moduleId:[String,Number],replyMethod:Function},data(){return{loading:!1,note:h.exports.cloneDeep(g),default:h.exports.cloneDeep(g)}},emits:["create"],methods:{onSubmit(){console.func("components/base/BaseReplyCard:methods.onSubmit()",arguments),this.loading=!0,this.replyMethod({...this.$props,...this.note}).then(({data:a,message:i})=>{this.note=h.exports.cloneDeep(g),this.default=h.exports.cloneDeep(g),this.$q.notify(i),this.$emit("create",a),this.loading=!1}).catch(a=>{this.loading=!1,this.$core.error(a,{title:this.$t("dialog.title.error")})})},onAttachFile(){console.func("components/base/BaseReplyCard:methods.onAttachFile()",arguments),this.$q.dialog({component:I,componentProps:{title:this.$t("attachFile"),multiple:!0}}).onOk(a=>{console.func("components/base/BaseReplyCard:methods.onAttachFile.onOk()",a),this.note.media=a})}},computed:{...q(V,{current:"user"}),currentUser(){return this.creating?this.current:this.user},color(){return this.$parent.color||"primary"},title(){return this.user?this.user.name:""},hasUser(){return Boolean(this.user)},has_icon(){return this.icon||this.avatar||this.user||this.creating},disable(){return JSON.stringify(this.note)===JSON.stringify(this.default)},getMessage(){return this.message?this.message.replace(/\r?\n/g,"<br/>"):this.message},getMedia(){return this.media||this.note.media},dateTime(){return this.$core.formatDateAsHuman(this.created_at)}}},L={key:0,class:"q-timeline__subtitle"},H={key:0,class:"q-ml-sm text-grey-8 text-weight-medium"},z=["src"],J={class:"q-timeline__content"},j=["innerHTML"],P={key:0,class:"text-grey-8 text-weight-medium"},W={key:2,class:"q-pt-sm files"},G={class:"row q-col-gutter-sm"},K={key:3,class:"actions-buttons flex q-gutter-sm items-center"};function X(a,i,s,S,o,e){const p=m("base-avatar"),x=m("base-media-card"),C=m("enquiry-status"),y=m("base-btn");return t(),n("li",{class:b({"q-timeline__entry reply-card":!0,"q-timeline__entry--right":!0,"q-timeline__entry--icon":e.has_icon})},[!s.creating&&e.hasUser?(t(),n("div",L,[c("span",null,f(e.title),1),e.dateTime?(t(),n("span",H,f(e.dateTime),1)):l("",!0)])):l("",!0),c("div",{class:b(`q-timeline__dot text-${e.color}`)},[s.avatar?(t(),n("img",{key:0,class:"q-timeline__dot-img",src:s.avatar},null,8,z)):s.icon?(t(),r(F,{key:1,name:s.icon},null,8,["name"])):e.currentUser?(t(),r(p,{key:2,class:"q-timeline__dot-img",tooltip:!1,size:"30px",user:e.currentUser},null,8,["user"])):l("",!0)],2),c("div",J,[s.creating?(t(),r(U,{key:0,class:"note-editor q-mb-sm",placeholder:a.$t("placeholder.leaveReply"),outlined:"",modelValue:o.note.message,"onUpdate:modelValue":i[0]||(i[0]=u=>o.note.message=u),type:"textarea",autogrow:""},null,8,["placeholder","modelValue"])):(t(),r(A,{key:1,style:{"min-height":"auto"},dense:"",class:"message q-pa-none"},{default:_(()=>[d(v,null,{default:_(()=>[d(R,null,{default:_(()=>[c("div",{innerHTML:e.getMessage},null,8,j)]),_:1})]),_:1}),e.hasUser?l("",!0):(t(),r(v,{key:0,side:""},{default:_(()=>[e.dateTime?(t(),n("span",P,f(e.dateTime),1)):l("",!0)]),_:1}))]),_:1})),e.getMedia.length?(t(),n("div",W,[c("div",G,[(t(!0),n(M,null,N(e.getMedia,(u,B)=>(t(),n("div",{key:u.id,class:"col-sm-2 col-xs-12"},[d(x,{creating:s.creating,media:u,onRemove:Y=>o.note.media.splice(B,1)},null,8,["creating","media","onRemove"])]))),128))])])):l("",!0),s.creating?(t(),n("div",K,[a.$q.screen.gt.xs?(t(),r(D,{key:0})):l("",!0),s.isAdmin?(t(),r(C,{key:1,modelValue:o.note.status,"onUpdate:modelValue":i[1]||(i[1]=u=>o.note.status=u),prefix:a.$t("prefix.status")},null,8,["modelValue","prefix"])):l("",!0),d(y,{color:"grey-5",icon:"far fa-paperclip",label:a.$t("attachFile"),onClick:e.onAttachFile},null,8,["label","onClick"]),d(y,{loading:o.loading,color:"primary",label:a.$t("reply"),icon:"fas fa-paper-plane",onClick:e.onSubmit,disable:e.disable},null,8,["loading","label","onClick","disable"])])):l("",!0)])],2)}var te=k(E,[["render",X],["__scopeId","data-v-4528f3da"]]);export{te as R};

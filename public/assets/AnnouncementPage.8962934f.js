import{_ as k,m as u,T as q,d as a,o as _,e as f,w as l,g as m,h as o,j as r,t as p,O as C}from"./index.ec7eb99e.js";import{Q as D}from"./QPage.b13c45b6.js";import{S as v}from"./SkeletonSinglePage.dba71dd3.js";import{u as N}from"./announcement.23c9ce00.js";import"./QSkeleton.73bc54f6.js";const g={is_closed:!1},w={components:{SkeletonSinglePage:v},data(){return{default:u.exports.cloneDeep(g),announcement:u.exports.cloneDeep(g),loaded:!1,submited:!1}},methods:{...q(N,["store","show","update"]),onSubmit(n){console.func("pages/admins/announcements/AnnouncementPage:methods.onSubmit()",arguments),this.submited=!0;const t=this.creating?this.store:this.update,h=u.exports.cloneDeep(this.announcement);this.announcement.is_closed&&Object.assign(h,{open_at:null,close_at:null}),t(h).then(({data:i,message:e})=>{this.submited=!1,this.$q.notify(e),this.announcement=i,this.default=u.exports.cloneDeep(i),this.$router.push({name:"Announcement",params:{id:i.id},query:{action:"edit"}})}).catch(i=>{this.submited=!1,this.$core.error(i,{title:this.$t("dialog.title.error")})})},onReset(n){console.func("pages/admins/announcements/AnnouncementPage:methods.onReset()",arguments),this.loaded=!1,this.$nextTick(()=>{this.announcement=u.exports.cloneDeep(this.default),this.loaded=!0})},onCancel(n){console.func("pages/admins/announcements/AnnouncementPage:methods.onCancel()",arguments),this.$router.go(-1)}},async mounted(){this.creating?this.loaded=!0:this.show(this.id).then(n=>{this.announcement=n,this.default=u.exports.cloneDeep(n),this.loaded=!0}).catch(n=>{this.$emit("error",n)})},computed:{edit(){return["add","edit"].includes(this.action)||this.id==="add"},creating(){return this.id==="add"},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.announcement)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.announcement)!==JSON.stringify(this.default)}}},O={class:"q-gutter-md"},P={class:"col-xs-12 col-sm-4"},R={class:"col-xs-12 col-sm-4"},U={class:"col-xs-12 col-sm-4"},J={class:"col-xs-12 col-sm-12"};function B(n,t,h,i,e,d){const c=a("base-label"),V=a("base-date-input"),b=a("base-time-input"),y=a("base-input"),S=a("base-section"),x=a("base-form"),A=a("skeleton-single-page");return _(),f(D,{padding:""},{default:l(()=>[e.loaded?(_(),f(x,{key:0,onSubmit:d.onSubmit,onCancel:d.onCancel,onReset:d.onReset,resetable:d.resetable,disable:d.disable,submited:e.submited},{default:l(()=>[m("div",O,[o(S,{flat:"",bordered:"",title:n.$t("generalInformation")},{default:l(()=>[m("div",P,[o(c,{required:""},{default:l(()=>[r(p(n.$t("date")),1)]),_:1}),o(V,{outlined:"",dense:"",modelValue:e.announcement.date,"onUpdate:modelValue":t[0]||(t[0]=s=>e.announcement.date=s),name:"date"},null,8,["modelValue"]),o(C,{class:"q-mt-md",dense:"",modelValue:e.announcement.is_closed,"onUpdate:modelValue":t[1]||(t[1]=s=>e.announcement.is_closed=s),label:n.$t("closeAllDay"),color:"green",name:"is_closed"},null,8,["modelValue","label"])]),m("div",R,[o(c,{required:""},{default:l(()=>[r(p(n.$t("openAt")),1)]),_:1}),o(b,{outlined:"",style:{width:"auto"},modelValue:e.announcement.open_at,"onUpdate:modelValue":t[2]||(t[2]=s=>e.announcement.open_at=s),disable:e.announcement.is_closed,name:"open_at"},null,8,["modelValue","disable"])]),m("div",U,[o(c,{required:""},{default:l(()=>[r(p(n.$t("closeAt")),1)]),_:1}),o(b,{outlined:"",style:{width:"auto"},modelValue:e.announcement.close_at,"onUpdate:modelValue":t[3]||(t[3]=s=>e.announcement.close_at=s),disable:e.announcement.is_closed,name:"close_at"},null,8,["modelValue","disable"])]),m("div",J,[o(c,{required:""},{default:l(()=>[r(p(n.$t("note")),1)]),_:1}),o(y,{type:"textarea",name:"note",modelValue:e.announcement.note,"onUpdate:modelValue":t[4]||(t[4]=s=>e.announcement.note=s)},null,8,["modelValue"])])]),_:1},8,["title"])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(_(),f(A,{key:1}))]),_:1})}var E=k(w,[["render",B]]);export{E as default};

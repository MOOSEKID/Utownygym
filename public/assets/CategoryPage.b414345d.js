import{_ as T,cr as J,m as g,T as _,U as S,d as i,o as h,e as b,w as n,g as l,h as o,j as u,t as c,R as Q,N as V,ae as I,i as z}from"./index.ec7eb99e.js";import{Q as F}from"./QPage.b13c45b6.js";import{C as j}from"./CategorySelect.3b1ceb8f.js";import{S as E}from"./SeoSection.b5bacff3.js";import{S as G}from"./SkeletonSinglePage.dba71dd3.js";import{u as v}from"./category.83d9548f.js";import{u as w}from"./index.22ce7155.js";import"./QSelect.ad394656.js";import"./QField.ad3f8f9a.js";import"./QChip.cb7fa0e0.js";import"./QMenu.76199ca9.js";import"./selection.571043d0.js";import"./rtl.276c3f1b.js";import"./QSkeleton.73bc54f6.js";import"./tag.6f04df2c.js";import"./collection.5ec0fec2.js";const q={name:"",description:"",status:"Draft"},L={components:{CategorySelect:j,SeoSection:E,SkeletonSinglePage:G,ThumbnailSelector:J},data(){return{loaded:!1,submited:!1,default:g.exports.cloneDeep(q),category:g.exports.cloneDeep(q),options:[],pagination:{sortBy:"TITLE_ASC",descending:!1,page:1,filter:"",rowsPerPage:15,rowsNumber:15,loaded:!1,loading:!1}}},methods:{..._(v,["show","store","update"]),..._(w,["get"]),onSubmit(e){console.func("pages/categories/category:methods.onSubmit()",arguments),this.submited=!0,(this.creating?this.store:this.update)(this.category).then(({data:d,message:p})=>{this.submited=!1,this.$q.notify(p),this.category=d,this.default=g.exports.cloneDeep(d),this.pagination.loading=!1,this.pagination.loaded=!0,this.$router.push({name:"Category",params:{id:d.id},query:{action:"edit"}})}).catch(d=>{this.submited=!1,this.$core.error(d,{title:this.$t("dialog.title.error")})})},onReset(e){console.func("pages/categories/category:methods.onReset()",arguments),this.loaded=!1,setTimeout(()=>{this.category=g.exports.cloneDeep(this.default),this.loaded=!0},1)},onCancel(e){console.func("pages/categories/category:methods.onCancel()",arguments),this.$router.back()},onRequestProduct(e){console.func("pages/categories/category:methods.onRequest()",arguments);const{page:a,rowsPerPage:d,sortBy:p,descending:t}=e.pagination;this.pagination=e.pagination,this.pagination.loading=!0,this.get({...e.pagination,descending:t?"desc":"asc",category:this.category.id}).then(({meta:r})=>{this.pagination.rowsNumber=r.total,this.pagination.page=a,this.pagination.rowsPerPage=d,this.pagination.sortBy=p,this.pagination.descending=t,this.pagination.loaded=!0,this.pagination.from=r.from,this.pagination.to=r.to,this.pagination.loading=!1}).catch(()=>{this.pagination.loading=!1})},onUpdateSortBy(){console.func("pages/categories/category:methods.onUpdateSortBy()",arguments),this.onRequestProduct({pagination:this.pagination})}},mounted(){this.creating?this.loaded=!0:this.show(this.id).then(e=>{this.category=e,this.default=g.exports.cloneDeep(e),this.loaded=!0}).catch(e=>{this.$core.error(e,{title:this.$t("dialog.title.error")})})},computed:{...S(w,["rows","sortOptions"]),...S(v,{columns:"productColumns"}),edit(){return["add","edit"].includes(this.action)||this.creating},creating(){return this.id==="add"},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.category)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.category)!==JSON.stringify(this.default)}}},M={class:"row q-col-gutter-md"},Y={class:"col-xs-12 col-sm-9"},H={class:"q-gutter-md"},K={class:"col-xs-12"},W={class:"col-xs-12"},X={class:"q-mb-md row q-col-gutter-md"},Z={class:"col"},$={class:"col-xs-12 col-sm-3"},ee={class:"q-gutter-md"};function te(e,a,d,p,t,r){const m=i("base-label"),C=i("base-input"),P=i("base-editor"),f=i("base-section"),y=i("base-select"),R=i("base-thumbnail"),U=i("base-btn"),k=i("base-status"),B=i("base-table"),N=i("seo-section"),D=i("category-select"),x=i("thumbnail-selector"),O=i("base-form"),A=i("skeleton-single-page");return h(),b(F,{padding:""},{default:n(()=>[t.loaded?(h(),b(O,{key:0,onSubmit:r.onSubmit,onCancel:r.onCancel,onReset:r.onReset,resetable:r.resetable,disable:r.disable,submited:t.submited},{default:n(()=>[l("div",M,[l("div",Y,[l("div",H,[o(f,{flat:"",bordered:"",title:"General information",description:"A great category title and description has the power to turn a casual shopper into a revenue-generating buyer."},{default:n(()=>[l("div",K,[o(m,null,{default:n(()=>[u(c(e.$t("label.name")),1)]),_:1}),o(C,{modelValue:t.category.name,"onUpdate:modelValue":a[0]||(a[0]=s=>t.category.name=s)},null,8,["modelValue"])]),l("div",W,[o(m,null,{default:n(()=>[u(c(e.$t("label.descriptionOptional")),1)]),_:1}),o(P,{modelValue:t.category.description,"onUpdate:modelValue":a[1]||(a[1]=s=>t.category.description=s),"min-height":"10rem"},null,8,["modelValue"])])]),_:1}),this.creating?z("",!0):(h(),b(f,{key:0,flat:"",bordered:"",title:"Products","no-row":""},{default:n(()=>[l("div",X,[l("div",Z,[o(y,{prefix:"Sort: ","map-options":"","emit-value":"",modelValue:t.pagination.sortBy,"onUpdate:modelValue":[a[2]||(a[2]=s=>t.pagination.sortBy=s),r.onUpdateSortBy],options:e.sortOptions,dense:"",outlined:""},null,8,["modelValue","options","onUpdate:modelValue"])])]),l("div",null,[o(B,{columns:e.columns,rows:e.rows,loading:t.pagination.loading,pagination:t.pagination,"hide-top":"",onRequest:r.onRequestProduct,"no-data-label":e.$t("label.noProductAvaialble")},{"body-cell-title":n(s=>[o(Q,{class:"q-pa-none",dense:""},{default:n(()=>[o(V,{avatar:""},{default:n(()=>[o(R,{size:40,media:s.row.thumbnail},null,8,["media"])]),_:2},1024),o(V,{avatar:""},{default:n(()=>[o(U,{onClick:a[3]||(a[3]=I(()=>{},["stop"])),link:"",size:"12px",tag:"a",to:{name:"Product",params:{id:s.row.id},query:{action:"edit"}}},{default:n(()=>[u(c(s.value),1)]),_:2},1032,["to"])]),_:2},1024)]),_:2},1024)]),"body-cell-status":n(s=>[o(k,{type:s.value},null,8,["type"])]),_:1},8,["columns","rows","loading","pagination","onRequest","no-data-label"])])]),_:1})),o(N,{prefix:"https://yourshop.com/categories/",modelValue:t.category,"onUpdate:modelValue":a[4]||(a[4]=s=>t.category=s),message:"Add a name and description to see how this category might appear in a search engine listing"},null,8,["modelValue"])])]),l("div",$,[o(f,{flat:"",bordered:"","no-row":""},{default:n(()=>[l("div",ee,[l("div",null,[o(m,null,{default:n(()=>[u(c(e.$t("label.categoryStatus")),1)]),_:1}),o(y,{modelValue:t.category.status,"onUpdate:modelValue":a[5]||(a[5]=s=>t.category.status=s),options:["Active","Draft"],dense:"",outlined:""},null,8,["modelValue"])]),l("div",null,[o(m,null,{default:n(()=>[u(c(e.$t("label.parent")),1)]),_:1}),o(D,{modelValue:t.category.parent,"onUpdate:modelValue":a[6]||(a[6]=s=>t.category.parent=s),hint:""},null,8,["modelValue"])]),l("div",null,[o(m,null,{default:n(()=>[u(c(e.$t("label.thumbnail")),1)]),_:1}),o(x,{loadFromServer:!0,"dialog-label":e.$t("label.uploadthumbnail"),icon:"fad fa-image",hint:"You can only choose images as category thumbnail.",modelValue:t.category.thumbnail,"onUpdate:modelValue":a[7]||(a[7]=s=>t.category.thumbnail=s)},null,8,["dialog-label","modelValue"])])])]),_:1})])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(h(),b(A,{key:1}))]),_:1})}var ye=T(L,[["render",te]]);export{ye as default};

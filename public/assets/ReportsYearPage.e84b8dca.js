import{_ as Y,m as R,T as q,U as h,u as A,d as i,o as s,e as c,w as o,h as a,g as k,f as u,p as x,F as g,O as B,t as m,i as P,s as U,j as p}from"./index.ec7eb99e.js";import{Q as n}from"./QTd.ce5eb0a5.js";import{Q as b}from"./QTr.4bf4ade2.js";import{Q as F}from"./QPage.b13c45b6.js";import{R as L,u as v}from"./ReportsTable.a50e0904.js";import{u as N}from"./mixins.af528ab3.js";import"./member.8ccf3331.js";import"./StateSelect.d3ce42fc.js";import"./index.becf6c0c.js";import"./CitySelect.367b922a.js";import"./BaseSectionSkeleton.971da8dd.js";import"./QSkeleton.73bc54f6.js";import"./page.e7247b54.js";import"./QExpansionItem.38c12bfd.js";import"./QSlideTransition.d1b840b3.js";import"./QMenu.76199ca9.js";import"./selection.571043d0.js";import"./SkeletonSinglePage.dba71dd3.js";const f=new Date().getFullYear(),j=R.exports.range(f,f-5).map(e=>({id:e.toString(),label:e===f?"Current Year":e.toString(),checked:!1,type:null})),D={components:{ReportsTable:L},mixins:[N],data(){return{loaded:!1,rows:j,year:f}},methods:{...q(v,["reportsYearly"]),onRequest(e,r){console.func("pages/admins/members/ReportsPage:methods.onRequest()",arguments),Object.assign(r.row,{total:void 0,total_paid:void 0,rolling:void 0,rolling_total:void 0,end_date:void 0,end_date_total:void 0,free:void 0,cancelled_total:void 0,cancelled:void 0,type:void 0,expand:!1}),e&&this.reportsYearly({year:r.row.id}).then(y=>{Object.assign(r.row,y)})},onLoad(e,r){if(console.func("pages/admins/members/ReportsPage:methods.onLoad()",arguments),e.row.expand&&r===e.row.type){e.row.expand=!1;return}else e.row.expand=!1,e.row.type=null;this.$nextTick(()=>{e.row.type=r,e.row.expand=!0})},onAdd(){console.func("pages/admins/members/ReportsPage:methods.onAdd()",arguments);const e=this.rows[this.rows.length-1].id-1;this.rows.push({id:e.toString(),label:e.toString(),checked:!1,type:null})}},mounted(){setTimeout(()=>{this.loaded=!0},500)},computed:{...h(A,["stats"]),...h(v,{columns:"yearlyReportColumns"}),years(){return R.exports.range(2015,new Date().getFullYear()+1,1)}}},O={class:"col"},$={class:"row q-col-gutter-md"},M={key:1};function E(e,r,y,z,w,_){const V=i("base-input"),T=i("base-btn"),C=i("reports-table"),Q=i("base-table"),S=i("base-section");return s(),c(F,{padding:""},{default:o(()=>[a(S,{title:e.$t("menus.yearlyReports"),flat:"",bordered:"","no-row":""},{default:o(()=>[a(Q,{"rows-per-page-options":[0],loaded:w.loaded,rows:w.rows,columns:e.columns,"hide-pagination":"","no-responsive":""},{top:o(()=>[k("div",O,[k("div",$,[(s(!0),u(g,null,x(e.columns.filter(t=>t.stats),(t,l)=>(s(),u("div",{key:l,class:"col-xs-6 col-sm"},[a(V,{prefix:`${t.label}:`,readonly:"",modelValue:e.stats[t.name],"onUpdate:modelValue":d=>e.stats[t.name]=d},null,8,["prefix","modelValue","onUpdate:modelValue"])]))),128))])])]),body:o(t=>[a(b,{props:t},{default:o(()=>[(s(!0),u(g,null,x(t.cols,l=>(s(),c(n,{key:l.name,props:t},{default:o(()=>[l.name==="id"?(s(),c(B,{key:0,dense:"",modelValue:t.row.checked,"onUpdate:modelValue":[d=>t.row.checked=d,d=>_.onRequest(d,t)],label:l.value},null,8,["modelValue","onUpdate:modelValue","label"])):(s(),u(g,{key:1},[l.value&&l.load?(s(),c(T,{key:0,link:"",color:"black",onClick:d=>_.onLoad(t,l.name),flat:"",dense:"",label:l.value},null,8,["onClick","label"])):(s(),u("span",M,m(l.value),1))],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),t.row.expand?(s(),c(b,{key:0,props:t},{default:o(()=>[a(n,{class:"q-pa-none",colspan:"100%"},{default:o(()=>[a(C,{"no-responsive":"",type:t.row.type,year:t.row.id},null,8,["type","year"])]),_:2},1024)]),_:2},1032,["props"])):P("",!0)]),"bottom-row":o(()=>[a(b,{"no-hover":""},{default:o(()=>[a(n,{class:"text-bold",colspan:"2"},{default:o(()=>[a(U,{flat:"",color:"primary",icon:"fad fa-circle-plus",dense:"",round:"",onClick:_.onAdd},null,8,["onClick"])]),_:1}),a(n,{align:"center",class:"text-bold",colspan:"1"},{default:o(()=>[p(m(e.getTotal("rolling_total")),1)]),_:1}),a(n,{align:"center",class:"text-bold",colspan:"1"}),a(n,{align:"center",class:"text-bold",colspan:"1"},{default:o(()=>[p(m(e.getTotal("end_date_total")),1)]),_:1}),a(n,{align:"center",class:"text-bold",colspan:"1"}),a(n,{align:"center",class:"text-bold",colspan:"1"}),a(n,{align:"center",class:"text-bold",colspan:"1"},{default:o(()=>[p(m(e.getTotal("cancelled_total")),1)]),_:1}),a(n,{align:"center",class:"text-bold",colspan:"1"}),a(n,{align:"center",class:"text-bold",colspan:"1"},{default:o(()=>[p(m(e.getTotal("total_paid")),1)]),_:1})]),_:1})]),_:1},8,["loaded","rows","columns"])]),_:1},8,["title"])]),_:1})}var ce=Y(D,[["render",E]]);export{ce as default};
